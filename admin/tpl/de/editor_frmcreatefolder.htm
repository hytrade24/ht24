{loadperm(editor_images)}
    <link href="../fckeditor/editor/filemanager/browser/default/browser.css" type="text/css" rel="stylesheet">
    <script type="text/javascript" src="../fckeditor/editor/filemanager/browser/default/js/common.js"></script>
    <script language="javascript">

function SetCurrentFolder( resourceType, folderPath )
{
  oConnector.ResourceType = resourceType ;
  oConnector.CurrentFolder = folderPath
}

function CreateFolder()
{
  var sFolderName ;
  //alert('path: '+oConnector.CurrentFolder);
  while ( true )
  {
    sFolderName = prompt( 'Type the name of the new folder:', '' ) ;

    if ( sFolderName == null )
      return ;
    else if ( sFolderName.length == 0 )
      alert( 'Please type the folder name' ) ;
    else
      break ;
  }

  oConnector.SendCommand( 'CreateFolder', 'NewFolderName=' + escape( sFolderName) , CreateFolderCallBack ) ;
}

function CreateFolderCallBack( fckXml )
{
  // Get the current folder path.
  var oNode = fckXml.SelectSingleNode( 'Connector/Error' ) ;
  var iErrorNumber = parseInt( oNode.attributes.getNamedItem('number').value ) ;

  switch ( iErrorNumber )
  {
    case 0 :
      window.parent.frames['frmResourcesList'].Refresh() ;
      break ;
    case 101 :
      alert( 'Folder already exists' ) ;
      break ;
    case 102 :
      alert( 'Invalid folder name' ) ;
      break ;
    case 103 :
      alert( 'You have no permissions to create the folder' ) ;
      break ;
    case 110 :
      alert( 'Unknown error creating folder' ) ;
      break ;
    default :
      alert( 'Error creating folder. Error number: ' + iErrorNumber ) ;
      break ;
  }
}

window.onload = function()
{
  window.top.IsLoadedCreateFolder = true ;
}
    </script>

    <table height="100%" cellSpacing="0" cellPadding="0" width="100%" border="0">
      <tr>
        <td>
          <button type="button" style="WIDTH: 100%" onclick="CreateFolder();"{if !perm_editor_images_C} disabled{endif}>
            <table cellSpacing="0" cellPadding="0" border="0">
              <tr>
                <td><img height="16" src="../fckeditor/editor/filemanager/browser/default/images/Folder.gif" width="16"></td>
                <td>&nbsp;</td>
                <td nowrap>Create New Folder</td>
              </tr>
            </table>
          </button>
        </td>
      </tr>
    </table>


