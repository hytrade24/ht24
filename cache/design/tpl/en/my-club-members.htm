<script type="text/javascript">
    jQuery(function() {
    	function setClubFormular(d) {
            if(d) {
                jQuery(".visibleOnEnabledClub").show();
            } else {
                jQuery(".visibleOnEnabledClub").hide();
            }
        }

        jQuery("#clubFormular input[name=STATUS]").change(function(){ setClubFormular(this.checked); })

        setClubFormular({if CLUB_STATUS}true{else}false{endif});
    });

	function showMemberRequestReason(clubMemberRequestId) {
		ShowContentDialog(jQuery("#clubMemberRequestReason-" + clubMemberRequestId).html(), "Reason for joining");
	}
    
function ToggleStats(link) {
	if ($("#stats iframe").attr("src") == "about:blank") {
		// Not loaded yet
    jQuery("#stats iframe").attr("src", "{uri_baseurl(index.php?frame=stats&page=ui_stats&show=user_anmeldungen)}&club={CLUB_ID_CLUB}");
	}
	$("#stats iframe").toggle();
}
</script>

<h1>{if CLUB_NAME}{htm(CLUB_NAME)} - {endif}Group index</h1>

{subtpl(tpl/{SYS_TPL_LANG}/my-club-members.modal.htm,*)}

{if saved | added | kicked | uninvited | promoted | request_declined | request_accepted | request_blocked}
<div class="alert alert-success">
	<button type="button" class="close" data-dismiss="alert">&times;</button>
	{if saved}<h4>Settings saved!</h4>{endif}
	{if added}<h4>Invite user!</h4>{endif}
	{if kicked}<h4>User was removed from this group!</h4>{endif}
	{if uninvited}<h4>Invite deleted successfully!</h4>{endif}
	{if promoted}<h4>Group leadership commited!</h4>{endif}
	{if mod_added}<h4>Member successfully appointed to a moderator!</h4>{endif}
	{if mod_removed}<h4>Moderator-rights has been withdrawn from the member!</h4>{endif}
	{if request_accepted}<h4>The application was accepted.</h4>{endif}
	{if request_declined}<h4>The application was declined.</h4>{endif}
	{if request_blocked}<h4>The application was declined and the user was blocked</h4>{endif}


</div>
{endif}
{if saved}
<div class="alert alert-success">
	<button type="button" class="close" data-dismiss="alert">&times;</button>

</div>
{endif}
{if errors}
<div class="alert alert-danger">
	<button type="button" class="close" data-dismiss="alert">&times;</button>
	<h4>Fehler!</h4>
	<ul>
		{errors}
	</ul>
</div>
{endif}

{if CLUB_ID_CLUB || CLUB_NEW}
	{subtpl(tpl/{SYS_TPL_LANG}/my-club-nav.htm,*)}

	{if liste_requests}
		<h3>Joining request</h3>
		<p>You have {count_member_requests} joining requests for this group. You can configurate the joining conditions in the  <a href="{uri_action(my-group,{CLUB_ID_CLUB},view)}">group settings</a>.</a> </p>
		<table class="table table-condensed table-striped">
			<thead>
				<tr>
					<th>Actions</th>
					<th>Username</th>
					<th>Requested at</th>
					<th>Reason</th>
				</tr>
			</thead>
			<tbody>
				{liste_requests}
			</tbody>
		</table>

		{if count_member_requests > 1 && !request_view}
			<p><a href="{uri_action(my-group-members,{CLUB_ID_CLUB},request_view)}">show all joining requests</a></p>
		{endif}

		{if request_view}
			<p class="pager">{pager}</p>
		{endif}
	{endif}

	{if !hide_members}
		<p>
			The group {htm(CLUB_NAME)} currently consists of these members:
		</p>
		<table class="table table-condensed table-striped">
			<thead>
				<tr>
					<th colspan="2">Actions</th>
					<th>Username</th>
					<th>Realname</th>
					<th>Member since</th>
					<th>Online</th>
				</tr>
			</thead>
			<tbody>
				{liste}
			</tbody>
		</table>

		<p class="pager">{pager}</p>

		{if CLUB_MODERATOR}
		<p class="btn-group" style="float: right;">
			<a class="btn btn-success" onclick="addUser();">
				<i class="icon icon-plus icon-white"></i>
				Add new member
			</a>
		</p>
	{endif}
	<br style="clear: both;" />

<div id="stats" class="alert alert-success">
	Click here, to display your member stats
	<a href="#statistics" onclick="return ToggleStats(this);">
		<img src="{uri_resource(/images/icons/stats-s.png)}" />
	</a>
	<iframe src="about:blank" frameborder="0" style="width: 100%; height: 240px; display: none;"></iframe>
</div>

	{endif}
	<div class="design-content-box design-icon-legend">
		<div class="pull-left">
			<a class="btn btn-default"><i class="glyphicon glyphicon-envelope"></i></a> = Write message
		</div>
		<div class="pull-left">
			<a class="btn btn-default"><i class="glyphicon glyphicon-share-alt"></i></a> = Commit group leadership
		</div>
		<div class="pull-left">
			<a class="btn btn-default"><i class="glyphicon glyphicon-star"></i></a> = Give moderation rights
		</div>
		<br style="clear: left;" />

		<div class="pull-left">
			<a class="btn btn-default"><i class="glyphicon glyphicon-star-empty"></i></a> = Take moderator rights
		</div>
		<div class="pull-left">
			<a class="btn btn-danger"><i class="glyphicon glyphicon-trash icon-white"></i></a> = Remove member
		</div>
		<div class="pull-left">
			<a class="btn btn-danger"><i class="glyphicon glyphicon-remove icon-white"></i></a> = Delete invite
		</div>
		<br style="clear: left;" />

		<div class="pull-left clearfix">
			<i class="glyphicon glyphicon-star"></i> = is group-leader
		</div>
		<div class="pull-left clearfix">
			<i class="glyphicon glyphicon-bullhorn"></i> = Moderator
		</div>
	</div>
{endif}